# 🎯 对话模式指南

## 概述

LLMSider 提供三种不同的对话模式,每种模式针对不同的用例进行了优化。选择合适的模式以匹配您的工作流程,从 AI 辅助中获得最佳结果。

---

## 🗣️ 普通模式

### 什么是普通模式?

**直接、即时的 AI 对话** - 就像与知识渊博的助手聊天。

```
您: 冥想有什么好处?
AI: 冥想提供多种好处,包括减轻压力、
    提高专注力、更好的情绪调节和增强
    自我意识。研究表明...
```

### 特点

| 方面 | 描述 |
|--------|-------------|
| **速度** | ⚡⚡⚡ 即时响应 |
| **复杂性** | 简单到中等任务 |
| **控制** | 最少的用户干预 |
| **工具使用** | 有限(仅用户发起) |
| **最适合** | 问答、头脑风暴、快速任务 |

### 何时使用

**✅ 适合:**
- 快速问答
- 头脑风暴想法
- 解释概念
- 生成草稿
- 随意对话
- 学习新主题

**❌ 不太理想:**
- 复杂的多步骤任务
- 需要执行工具的任务
- 需要多个来源的研究
- 文件操作

---

## 🎯 引导模式

### 什么是引导模式?

**交互式、逐步的工具确认对话** - AI 逐个建议操作，您在执行前批准它们。

```
您: 创建一个关于机器学习的研究笔记

AI: 我可以帮您。首先，我应该为笔记创建一个文件。
    
    [工具建议]
    工具: create_file
    参数: { path: "machine-learning.md", content: "# Machine Learning\n\n" }
    
    [批准] [拒绝]

您: [批准]

AI: 文件已创建。现在，我应该搜索一些关键概念来添加吗？
```

### 特点

| 方面 | 描述 |
|--------|-------------|
| **速度** | ⚡⚡ 中等(需要批准) |
| **复杂性** | 中等到高 |
| **控制** | ⭐⭐⭐ 高用户控制 |
| **工具使用** | 逐个批准 |
| **最适合** | 学习、复杂任务、安全性 |

### 何时使用

**✅ 适合:**
- 您希望完全控制的任务
- 学习 AI 如何使用工具
- 敏感的文件操作
- 确保每一步的准确性
- 协作解决问题

**❌ 不太理想:**
- 完全自主的任务
- 速度 (代理模式更快)
- 简单问答 (普通模式更好)

### 工作流程

1. **用户请求**: 您提出要求。
2. **AI 建议**: AI 建议工具调用或提出澄清问题。
3. **用户操作**: 您批准工具或回答问题。
4. **执行**: 工具运行 (如果已批准)。
5. **循环**: AI 分析结果并建议下一步。

### 示例工作流程

#### 1. 受控研究
```
您: 查找有关最新 React 版本的信息。

AI: 我将搜索 "React latest version release notes"。
    [工具: google_search]
    [批准] [拒绝]

您: 批准。

AI: 找到了 React 19。现在我将获取官方博客文章。
    [工具: fetch_url]
    [批准] [拒绝]
```

#### 2. 安全文件编辑
```
您: 重构此文件。

AI: 我先读取文件。
    [工具: read_file]
    [批准]

AI: 我看到了代码。我现在应用更改。
    [工具: edit_file]
    [批准]
```

---

## 🤖 代理模式

### 什么是代理模式?

**自主计划与执行** - AI 分析您的请求，生成完整计划 (顺序或 DAG)，并自动执行。

```
您: 研究并比较前 5 种编程语言

AI: [已生成计划]
    1. 搜索排名 (并行)
    2. 获取 Python 详情 (并行)
    3. 获取 JavaScript 详情 (并行)
    ...
    6. 创建比较报告 (顺序)

    [正在执行步骤 1...]
    [正在执行步骤 2...]
    ...
    
    ✓ 任务完成!
```

### 特点

| 方面 | 描述 |
|--------|-------------|
| **速度** | ⚡⚡ 中等(需要批准) |
| **复杂性** | 中等到高 |
| **控制** | ⭐⭐⭐ 高用户控制 |
| **工具使用** | 逐步批准 |
| **最适合** | 学习、复杂任务、安全性 |

### 何时使用

**✅ 适合:**
- 复杂的多步骤任务
- 学习新工作流程
- 需要验证的任务
- 敏感操作
- 教育目的
- 确保准确性

**❌ 不太理想:**
- 简单问题
- 快速查找
- 时间敏感的任务
- 高度重复的操作

---

## 🤖 代理模式

### 什么是代理模式?

**具有完全工具访问权限的自主 AI** - AI 决定使用哪些工具并自动执行它们以完成您的目标。

```
您: 研究并比较前 5 种编程语言

AI: [工具: Google 搜索] 搜索编程语言排名...
    [工具: 获取内容] 获取 Stack Overflow 数据...
    [工具: 获取内容] 获取 GitHub 统计数据...
    [工具: 创建文件] 创建 comparison-chart.md...
    [工具: 编辑文件] 添加语言比较表...
    
    ✓ 使用最新数据创建了综合比较!
```

### 特点

| 方面 | 描述 |
|--------|-------------|
| **速度** | ⚡⚡⚡ 快速(无需批准) |
| **复杂性** | 高 - 处理任何事情 |
| **控制** | ⭐ 低(自主) |
| **工具使用** | 自动使用所有工具 |
| **最适合** | 研究、自动化、数据 |

### 何时使用

**✅ 适合:**
- 研究和数据收集
- 重复性任务
- 多工具工作流程
- 综合分析
- 自动化
- 节省时间的操作

**❌ 不太理想:**
- 敏感文件操作
- 学习新工作流程
- 需要人工判断的任务
- 破坏性操作

---

## 🔄 模式比较

### 功能矩阵

| 功能 | 普通 | 引导 | 代理 |
|---------|--------|--------|-------|
| **工具访问** | 手动 | 已批准 | 自动 |
| **多步骤** | ❌ | ✅ | ✅ |
| **需要批准** | 不适用 | ✅ | ❌ |
| **速度** | 快速 | 中等 | 快速 |
| **控制** | 无 | 高 | 低 |
| **学习曲线** | 低 | 中等 | 低 |
| **安全性** | ✅ 高 | ✅ 高 | ⚠️ 中等 |

### 任务适用性

| 任务类型 | 推荐模式 |
|-----------|------------------|
| **简单问答** | 普通 |
| **复杂研究** | 代理 |
| **文件操作** | 引导 |
| **头脑风暴** | 普通 |
| **多步骤项目** | 引导 |
| **数据收集** | 代理 |
| **学习工作流程** | 引导 |
| **快速草稿** | 普通 |
| **自动化** | 代理 |

---

## 📝 消息操作按钮

当你将鼠标悬停在消息上时,会出现一组操作按钮。不同的消息类型显示不同的按钮。

### 用户消息操作

当您悬停在**您自己发送的消息**上时:

| 按钮 | 图标 | 功能 | 使用场景 |
|------|------|------|----------|
| **复制消息** | 📋 | 将消息内容复制到剪贴板 | 快速复制你的提问 |
| **编辑消息** | ✏️ | 编辑此消息(会删除此消息及之后的所有消息) | 修正拼写错误或调整问题 |

**注意**: 编辑用户消息会撤回该消息及后续的所有对话,内容会被放回输入框供你修改。

---

### 助手消息操作

当您悬停在 **AI 助手的回复**上时:

#### 基础操作(所有模式均可用)

| 按钮 | 图标 | 功能 | 使用场景 |
|------|------|------|----------|
| **复制为 Markdown** | 📋 | 以 Markdown 格式复制响应内容 | 保留格式复制到其他地方 |
| **生成新笔记** | 📄 | 从此响应创建新笔记文件 | 将 AI 回答保存为永久笔记 |
| **插入到光标处** | ↙️ | 在当前编辑器光标位置插入内容 | 快速将回答插入到笔记中 |
| **重新生成** | 🔄 | 删除此响应并重新生成 | 对回答不满意时重试 |
| **比较其他模型** | 🔀 | 添加其他模型进行对比 | 同时查看多个模型的回答 |

#### 高级操作(仅在引导/普通模式)

当消息包含**文本修改建议**或**选中文本上下文**时,会出现额外按钮:

| 按钮 | 图标 | 功能 | 使用场景 |
|------|------|------|----------|
| **应用更改** | ✅ | 将 AI 建议的修改应用到原文件 | 接受 AI 的编辑建议 |
| **切换差异视图** | 👁️ | 在渲染视图和差异对比视图之间切换 | 查看修改前后的对比 |

**注意**: 
- 差异相关按钮仅在有**单个文件引用**时显示
- 如果消息引用了**多个文件**,这些按钮会隐藏(因为无法确定应用到哪个文件)

---

### 使用技巧

#### 💡 生成新笔记
```
1. AI 回答后,悬停在消息上
2. 点击 📄 "生成新笔记"
3. AI 会自动生成标题
4. 笔记被创建并自动打开
```

#### ✂️ 应用代码修改
```
1. 选中一段代码
2. 右键 → "添加到 LLMSider 上下文"
3. 请求 AI: "优化这段代码"
4. AI 回复后,点击 👁️ 查看差异
5. 确认后点击 ✅ "应用更改"
```

#### 🔄 重新生成策略
```
如果第一次回答不理想:
1. 点击 🔄 重新生成
2. 或者点击 🔀 比较其他模型
3. 或者点击 ✏️ 编辑你的问题重新提问
```

---

## ⚠️ 重要提示

### 编辑消息
- 编辑用户消息会**删除该消息及之后的所有对话**
- 内容会被放回输入框,供你修改后重新发送
- 这是不可逆操作,请谨慎使用

### 应用更改
- 应用更改会**直接修改原始文件**
- 建议在应用前先点击 👁️ 查看差异
- 如需要,可以使用 Obsidian 的历史记录恢复

### 插入到光标处
- 确保有一个 **Markdown 编辑器**打开
- 如果没有活跃的编辑器,会自动切换到最近的一个
- 内容会插入到**当前光标位置**

---

## ⚡ 快捷访问

虽然没有直接的按钮快捷键,但你可以使用鼠标悬停快速访问:

```
悬停在消息上 → 按钮出现 → 点击执行
```

**提高效率的工作流:**
1. 鼠标移到消息上
2. 按钮立即显示
3. 点击所需操作
4. 无需右键菜单

---

## ⚙️ 配置

### 更改模式

**方法 1: 设置**
```
设置 → LLMSider → 对话模式
默认模式: [普通 | 引导 | 代理]
```

**方法 2: 在聊天中**
```
当前: 普通模式
[切换到引导] [切换到代理]
```

**方法 3: 每个会话**
```
右键会话 → 更改模式
```

---

## 💡 最佳实践

### 🎯 模式选择策略

**从普通开始,根据需要升级:**
```
简单任务 → 普通
  ↓ (如果需要工具)
增加复杂性 → 引导
  ↓ (如果有信心)
完全自动化 → 代理
```

**任务清单:**
```
□ 需要工具吗?
  → 否: 普通 | 是: 继续
□ 我需要审查每个步骤吗?
  → 是: 引导 | 否: 继续
□ AI 可以自主决定吗?
  → 是: 代理 | 否: 引导
```

---

## 🐛 故障排除

### 常见问题

**模式未切换:**
1. ✅ 检查设置已保存
2. ✅ 重新加载聊天视图
3. ✅ 重启 Obsidian
4. ✅ 清除缓存

**引导模式中的工具不工作:**
1. ✅ 确保工具已启用
2. ✅ 检查权限
3. ✅ 完全批准步骤
4. ✅ 审查错误消息

---

## 📚 示例库

### 普通模式示例

```markdown
1. "解释量子纠缠"
2. "写一首关于编码的俳句"
3. "TypeScript 有什么好处?"
4. "为学生头脑风暴 5 个应用创意"
5. "总结这篇文章: [粘贴 URL]"
```

### 引导模式示例

```markdown
1. "为博客创建综合项目计划"
2. "逐步解释重构此代码"
3. "建立新的笔记系统"
4. "将旧笔记迁移到新结构"
5. "研究并记录技术主题"
```

### 代理模式示例

```markdown
1. "研究前 10 个 AI 工具并创建比较表"
2. "从笔记库收集所有 TODO 项并排序"
3. "### 工具执行

#### 执行模式

代理模式支持两种执行策略(可在设置中配置):

1. **顺序模式 (默认)**
   - 步骤按顺序运行
   - 更安全,更易于调试
   - 如果步骤失败则停止

2. **DAG 模式 (并行)**
   - 独立步骤同时运行
   - 复杂任务更快
   - 示例: 同时搜索 5 个不同的主题

#### 自动工具选择
```
目标: "根据项目笔记创建周报告""
4. "查找并修复笔记库中的所有断开链接"
5. "从网络来源生成数据集并分析"
```

---

## 📖 相关指南

- [聊天界面](chat-interface.md) - 主要聊天功能
- [内置工具](built-in-tools.md) - 可用工具
- [MCP 集成](mcp-integration.md) - 外部工具
- [设置指南](settings-guide.md) - 配置

---

**有疑问?** [GitHub Issues](https://github.com/gnuhpc/obsidian-llmsider/issues)
